<div class="membership-page">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="hero-content">
        <h1 class="hero-title">Thortful Plus</h1>
        <p class="hero-subtitle">Plus perk: 30% off ALL cards</p>
        <p class="hero-description">
          Same amazing perks! Save 30% on all cards – the perfect way to make every occasion special without breaking the bank.
        </p>
        <div class="hero-cta">
          @if (offeringLoading$()) {
            <button class="cta-button" disabled>
              Loading...
            </button>
          } @else if (offeringError$()) {
            <p class="error-text">{{ offeringError$() }}</p>
          } @else {
            @let selectedPlan = getSelectedPlan();
            @if (selectedPlan) {
              <button class="cta-button" (click)="onSignUp()">
                Add Plus for {{ formatPrice(selectedPlan) }}/{{ formatInterval(selectedPlan) }}
              </button>
            }
          }
        </div>
      </div>
      <div class="hero-image">
        <img src="/assets/images/plus-hero.jpg" alt="Thortful Plus Hero" />
      </div>
    </div>
  </section>

  <!-- Benefits Grid -->
  <section class="benefits-section">
    <div class="container">
      <h2 class="section-title">Your exclusive benefits auto applied at checkout</h2>
      <div class="benefits-grid">
        @for (benefit of benefits; track benefit.title) {
          <div class="benefit-card">
            <div class="benefit-icon">{{ benefit.icon }}</div>
            <h3 class="benefit-title">{{ benefit.title }}</h3>
            <p class="benefit-description">{{ benefit.description }}</p>
          </div>
        }
      </div>
    </div>
  </section>

  <!-- Social Proof -->
  <section class="testimonials-section">
    <div class="container">
      <h2 class="section-title">5-star reviews from our happy customers</h2>
      <div class="testimonials-grid">
        @for (testimonial of testimonials; track testimonial.text) {
          <div class="testimonial-card">
            <div class="stars">
              @for (star of [1,2,3,4,5]; track star) {
                <span class="star">⭐</span>
              }
            </div>
            <p class="testimonial-text">{{ testimonial.text }}</p>
            <p class="testimonial-author">{{ testimonial.author }}</p>
          </div>
        }
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <div class="container">
      <div class="cta-content">
        <h2 class="cta-title">Ready to save on every card?</h2>
        <p class="cta-subtitle">Join Thortful Plus today and start enjoying exclusive benefits</p>
        @if (membershipStatus$().isActive) {
          <div class="member-status">
            <p class="member-badge">✨ You're a Thortful Plus member!</p>
            <p class="member-info">Your benefits are active until {{ membershipStatus$().expiresAt | date }}</p>
          </div>
        } @else {
          @let selectedPlan = getSelectedPlan();
          @if (selectedPlan) {
            <button class="cta-button-large" (click)="onSignUp()">
              Get Thortful Plus for {{ formatPrice(selectedPlan) }}/{{ formatInterval(selectedPlan) }}
            </button>
          } @else {
            <button class="cta-button-large" (click)="onSignUp()">
              Get Thortful Plus
            </button>
          }
          <p class="cta-disclaimer">Cancel anytime. T&Cs apply.</p>
        }
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="faq-section">
    <div class="container">
      <div class="faq-links">
        <a href="/support/thortful-plus" class="faq-link">
          <h3>Got a question?</h3>
          <p>Learn More</p>
        </a>
        <a href="/terms/thortful-plus" class="faq-link">
          <h3>The important bits</h3>
          <p>Read Now</p>
        </a>
      </div>
    </div>
  </section>

  <!-- Sign-up Modal -->
  @if (showSignUpModal()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <button class="modal-close" (click)="closeModal()">×</button>

        <h2 class="modal-title">Complete Your Thortful Plus Subscription</h2>

        <!-- Pricing Option Selection (Toggle/Tabs) -->
        @let allPricingOptions = getAllUniquePricingOptions();
        @if (allPricingOptions.length > 1) {
          <div class="pricing-option-tabs">
            @for (option of allPricingOptions; track option.id) {
              <button 
                class="pricing-tab"
                [class.active]="selectedPricingOptionId() === option.id"
                (click)="onPricingOptionChange(option.id)">
                {{ option.name || 'Option' }}
              </button>
            }
          </div>
        }

        <!-- Plan Selection -->
        @let availablePlans = getPlansForPricingOption(selectedPricingOptionId() || '');
        @if (availablePlans.length > 1) {
          <div class="plan-selection">
            <h3>Choose your plan:</h3>
            <div class="plans-grid">
              @for (plan of availablePlans; track plan.id) {
                <label class="plan-option" [class.selected]="selectedPlanId() === plan.id">
                  <input 
                    type="radio" 
                    name="plan" 
                    [value]="plan.id"
                    [checked]="selectedPlanId() === plan.id"
                    (change)="onPlanChange(plan.id)">
                  <span class="plan-name">{{ plan.attributes.name || 'Plan' }}</span>
                  <span class="plan-price">{{ formatPrice(plan) }}/{{ formatInterval(plan) }}</span>
                </label>
              }
            </div>
          </div>
        }

        <div class="subscription-summary">
          @let selectedPlan = getSelectedPlan();
          @if (selectedPlan) {
            <h3>{{ selectedPlan.attributes.name || 'Thortful Plus' }}</h3>
            <p class="price">{{ formatPrice(selectedPlan) }}/{{ formatInterval(selectedPlan) }}</p>

            @if (selectedPlan.attributes.description) {
              <p class="plan-description">{{ selectedPlan.attributes.description }}</p>
            }
          } @else {
            <h3>Thortful Plus</h3>
            <p class="price">£9.99/year</p>
          }

          <div class="benefits-summary">
            <h4>Your benefits include:</h4>
            <ul>
              @for (benefit of benefits; track benefit.title) {
                <li>{{ benefit.title }}</li>
              }
            </ul>
          </div>
        </div>

        @if (errorMessage()) {
          <div class="error-message">{{ errorMessage() }}</div>
        }

        <div class="modal-actions">
          <button
            class="confirm-button"
            (click)="confirmSubscription()"
            [disabled]="isProcessing()">
            @if (isProcessing()) {
              Processing...
            } @else {
              @let selectedPlan = getSelectedPlan();
              @if (selectedPlan) {
                Add to Cart - {{ formatPrice(selectedPlan) }}/{{ formatInterval(selectedPlan) }}
              } @else {
                Add to Cart
              }
            }
          </button>
          <button class="cancel-button" (click)="closeModal()" [disabled]="isProcessing()">
            Cancel
          </button>
        </div>

        <p class="terms-notice">
          By subscribing, you agree to our <a href="/terms/thortful-plus">Terms & Conditions</a>
        </p>
      </div>
    </div>
  }
</div>
